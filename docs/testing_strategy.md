# 1.7 Выбор стратегии тестирования, разработки тестов, программа и методика испытаний

## 1.7.1 Объект и цель испытаний

### 1.7.1.1 Объект испытаний

Объектом испытаний является программное обеспечение "Hockey Editor" - инструмент покадрового анализа хоккейных матчей, предназначенный для:

- Загрузки и воспроизведения видеофайлов различных форматов
- Создания и управления маркерами игровых событий
- Визуализации таймлайна с цветными дорожками событий
- Экспорта выделенных сегментов видео
- Управления проектами анализа матчей

Программное обеспечение состоит из следующих основных компонентов:

1. **Ядро приложения (Core)**:
   - VideoController - контроллер управления видео и маркерами
   - VideoProcessor - обработчик видеопотока
   - VideoExporter - экспортер видео сегментов
   - ProjectManager - менеджер проектов

2. **Пользовательский интерфейс (UI)**:
   - MainWindow - главное окно приложения
   - VideoWindow - окно видеоплеера
   - PreviewWindow - окно предварительного просмотра
   - TimelineWidget - виджет таймлайна
   - ExportDialog - диалог экспорта

3. **Модели данных**:
   - Marker - модель маркера события
   - Project - модель проекта

4. **Утилиты**:
   - SettingsManager - менеджер настроек
   - ShortcutManager - менеджер горячих клавиш
   - UndoRedo - система отмены/повтора операций

### 1.7.1.2 Цель испытаний

Основной целью испытаний является обеспечение высокого качества программного обеспечения путем:

1. **Валидации функциональности**:
   - Проверка корректной работы всех заявленных функций
   - Обеспечение точности позиционирования по кадрам
   - Валидация качества экспорта видео

2. **Обеспечения надежности**:
   - Стабильная работа при длительном использовании
   - Корректная обработка исключительных ситуаций
   - Восстановление после сбоев без потери данных

3. **Проверки производительности**:
   - Быстрая загрузка и обработка видео
   - Эффективное использование системных ресурсов
   - Стабильная работа с большими видеофайлами

4. **Валидации пользовательского опыта**:
   - Интуитивность интерфейса
   - Отзывчивость элементов управления
   - Корректность отображения информации

### 1.7.1.3 Критерии успешности испытаний

Испытания считаются успешными при выполнении следующих критериев:

- **Процент успешных тестов**: не менее 95%
- **Покрытие кода тестами**: не менее 80%
- **Отсутствие критических дефектов**: severity 1 и 2
- **Время выполнения полного набора тестов**: не более 30 минут
- **Стабильность работы**: отсутствие падений при нагрузке

## 1.7.2 Требования к информационному, аппаратно-программному обеспечению

### 1.7.2.1 Требования к функциональным характеристикам

#### Основные функциональные требования:

1. **Загрузка видео**:
   - Поддержка форматов: MP4, AVI, MOV, MKV
   - Максимальный размер файла: 10 GB
   - Минимальное разрешение: 640x480
   - Максимальное разрешение: 4K (3840x2160)

2. **Воспроизведение видео**:
   - Точность позиционирования: ±1 кадр
   - Поддержка скоростей: 0.25x - 4x
   - Плавность воспроизведения при 30 FPS

3. **Управление маркерами**:
   - Максимальное количество маркеров: 1000
   - Точность установки: ±1 кадр
   - Поддержка 13 типов событий + пользовательские

4. **Экспорт видео**:
   - Качество экспорта: без потери качества
   - Поддержка форматов: MP4, AVI
   - Максимальная продолжительность сегмента: 10 минут

#### Требования к надежности:

- **Время наработки на отказ**: не менее 4 часов непрерывной работы
- **Восстановление после сбоя**: автоматическое сохранение состояния
- **Обработка ошибок**: graceful degradation без потери данных

### 1.7.2.2 Требования к надежности

#### Показатели надежности:

1. **Среднее время наработки на отказ (MTBF)**: не менее 8 часов
2. **Среднее время восстановления (MTTR)**: не более 30 секунд
3. **Коэффициент готовности**: не менее 0.95 (95%)
4. **Уровень отказов**: не более 0.05% от общего времени работы

#### Требования к отказоустойчивости:

- Автоматическое сохранение проекта каждые 5 минут
- Восстановление состояния после неожиданного закрытия
- Валидация входных данных на всех уровнях
- Graceful handling исключительных ситуаций

### 1.7.2.3 Требования к составу и параметрам технических средств

#### Минимальные системные требования:

| Компонент | Минимальные требования | Рекомендуемые требования |
|-----------|------------------------|--------------------------|
| ОС | Windows 10 64-bit | Windows 11 64-bit |
| Процессор | Intel Core i5-4460 / AMD FX-6300 | Intel Core i7-8700K / AMD Ryzen 7 3700X |
| Оперативная память | 8 GB DDR4 | 16 GB DDR4 |
| Видеокарта | Intel HD Graphics 4600 / NVIDIA GTX 960 | NVIDIA RTX 3060 / AMD RX 6600 |
| Дисковое пространство | 2 GB SSD | 5 GB SSD |
| Дисплей | 1920x1080, 60Hz | 2560x1440, 144Hz |

#### Требования к тестовому окружению:

1. **Аппаратное обеспечение**:
   - Тестовые машины с различными конфигурациями
   - Системы захвата видео для интеграционного тестирования
   - Хранилище тестовых видеофайлов (минимум 100 GB)

2. **Программное обеспечение**:
   - Python 3.8+ с полным набором зависимостей
   - Системы виртуализации для кросс-платформенного тестирования
   - Инструменты для автоматизации тестирования

### 1.7.2.4 Требования к программной документации

#### Обязательная документация:

1. **Техническая документация**:
   - Полная спецификация API всех компонентов
   - Описание архитектуры и паттернов проектирования
   - Руководство по развертыванию и конфигурации

2. **Пользовательская документация**:
   - Руководство пользователя с примерами
   - Описание горячих клавиш и настроек
   - FAQ и troubleshooting guide

3. **Документация для тестирования**:
   - Спецификация тест-кейсов
   - Процедуры проведения испытаний
   - Критерии приемки и метрики качества

## 1.7.3 Состав, порядок и методы испытаний

### 1.7.3.1 Классификация видов тестирования

#### 1. Модульное тестирование (Unit Testing)

**Цель**: Проверка корректности работы отдельных модулей и функций

**Объекты тестирования**:
- VideoProcessor: загрузка, обработка кадров
- VideoExporter: экспорт сегментов
- Marker: сериализация/десериализация
- ProjectManager: сохранение/загрузка проектов

**Инструменты**: unittest, pytest

#### 2. Интеграционное тестирование (Integration Testing)

**Цель**: Проверка взаимодействия между компонентами

**Объекты тестирования**:
- VideoController + VideoProcessor
- UI компоненты + Core логика
- ProjectManager + File System

**Инструменты**: pytest с fixtures, mock объекты

#### 3. Системное тестирование (System Testing)

**Цель**: Проверка работы системы в целом

**Объекты тестирования**:
- Полный workflow от загрузки видео до экспорта
- Пользовательские сценарии использования
- Производительность и стабильность

**Инструменты**: Автоматизированные UI тесты, нагрузочное тестирование

#### 4. Приемочное тестирование (Acceptance Testing)

**Цель**: Валидация соответствия требованиям заказчика

**Объекты тестирования**:
- Функциональные требования
- Пользовательские сценарии
- Качество пользовательского опыта

**Инструменты**: Ручное тестирование, пользовательские тесты

### 1.7.3.2 Порядок проведения испытаний

#### Этап 1: Подготовка (1-2 дня)
- Настройка тестового окружения
- Подготовка тестовых данных
- Создание/обновление тест-кейсов

#### Этап 2: Модульное тестирование (2-3 дня)
- Запуск unit-тестов
- Анализ покрытия кода
- Исправление выявленных дефектов

#### Этап 3: Интеграционное тестирование (2-3 дня)
- Тестирование взаимодействия компонентов
- Проверка API контрактов
- Валидация обработки ошибок

#### Этап 4: Системное тестирование (3-5 дней)
- Полное тестирование функциональности
- Нагрузочное тестирование
- Тестирование производительности

#### Этап 5: Приемочное тестирование (1-2 дня)
- Финальная валидация требований
- Пользовательское тестирование
- Подготовка релизных артефактов

### 1.7.3.3 Методы испытаний

#### Метод "черного ящика"
Применяется для функционального тестирования:
- Эквивалентное разбиение
- Анализ граничных значений
- Тестирование переходов состояний

#### Метод "белого ящика"
Применяется для критических компонентов:
- Покрытие операторов (statement coverage) ≥ 80%
- Покрытие ветвей (branch coverage) ≥ 75%
- Покрытие условий (condition coverage) ≥ 70%

#### Исследовательское тестирование
Применяется для поиска неочевидных дефектов:
- Свободное исследование интерфейса
- Тестирование необычных сценариев
- Проверка обработки некорректных данных

### 1.7.3.4 Тест-кейсы

#### Тест-кейсы для VideoProcessor

**TC_VP_001**: Загрузка корректного видеофайла
- Предусловия: Существует MP4 файл размером 100MB
- Шаги:
  1. Создать экземпляр VideoProcessor
  2. Вызвать load() с путем к файлу
- Ожидаемый результат: Метод возвращает True, свойства fps, total_frames, resolution установлены корректно

**TC_VP_002**: Загрузка несуществующего файла
- Предусловия: Файл не существует
- Шаги:
  1. Создать экземпляр VideoProcessor
  2. Вызвать load() с несуществующим путем
- Ожидаемый результат: Метод возвращает False, исключения не возникают

**TC_VP_003**: Получение кадра по индексу
- Предусловия: Видео загружено успешно
- Шаги:
  1. Вызвать get_frame_at(100)
- Ожидаемый результат: Возвращается numpy array с корректными размерами

#### Тест-кейсы для VideoController

**TC_VC_001**: Создание маркера события
- Предусловия: Видео загружено, текущий кадр = 150
- Шаги:
  1. Вызвать on_hotkey_pressed("G") для события "Goal"
- Ожидаемый результат: Создан маркер с event_name="Attack", start_frame=150

**TC_VC_002**: Удаление маркера
- Предусловия: Существует маркер с индексом 0
- Шаги:
  1. Вызвать delete_marker(0)
- Ожидаемый результат: Маркер удален из списка, сигнал markers_changed отправлен

**TC_VC_003**: Undo/Redo операции
- Предусловия: Выполнена операция создания маркера
- Шаги:
  1. Вызвать undo()
  2. Вызвать redo()
- Ожидаемый результат: Состояние корректно восстановлено

#### Тест-кейсы для VideoExporter

**TC_VE_001**: Экспорт одиночного сегмента
- Предусловия: Существует видео и маркер (0-100 кадры)
- Шаги:
  1. Вызвать VideoExporter.export() с одним маркером
- Ожидаемый результат: Создан MP4 файл продолжительностью ~3.33 секунды

**TC_VE_002**: Экспорт нескольких сегментов
- Предусловия: Существует видео и 3 маркера
- Шаги:
  1. Вызвать VideoExporter.export() с тремя маркерами
- Ожидаемый результат: Создан MP4 файл с конкатенированными сегментами

**TC_VE_003**: Экспорт с пустым списком маркеров
- Предусловия: Существует видео, список маркеров пуст
- Шаги:
  1. Вызвать VideoExporter.export() с пустым списком
- Ожидаемый результат: Создан пустой видеофайл длительностью 0.1 секунды

#### Тест-кейсы для пользовательского интерфейса

**TC_UI_001**: Загрузка видео через меню
- Предусловия: Приложение запущено
- Шаги:
  1. Выбрать File → Open Video
  2. Выбрать MP4 файл
- Ожидаемый результат: Видео загружено, таймлайн обновлен

**TC_UI_002**: Создание маркера через горячую клавишу
- Предусловия: Видео загружено и воспроизводится
- Шаги:
  1. Нажать клавишу "G" во время воспроизведения
- Ожидаемый результат: Маркер создан, отображен на таймлайне

**TC_UI_003**: Экспорт через диалог
- Предусловия: Существуют маркеры
- Шаги:
  1. Выбрать Tools → Export
  2. Выбрать сегменты для экспорта
  3. Указать путь сохранения
  4. Нажать Export
- Ожидаемый результат: Диалог показывает прогресс, файл создан

### 1.7.3.5 Критерии приемки тест-кейсов

#### Успешное выполнение тест-кейса:
- Все проверки пройдены
- Нет исключений и ошибок
- Производительность в допустимых пределах
- Ресурсы освобождены корректно

#### Неуспешное выполнение тест-кейса:
- Любая проверка не пройдена
- Возникло необработанное исключение
- Производительность ниже допустимого порога
- Утечка ресурсов

## 1.7.4 Результаты проведения испытаний

### 1.7.4.1 Формат отчетов

#### Отчет о модульном тестировании
```
Тестовый набор: Unit Tests
Общее количество тестов: 45
Пройдено: 43 (95.6%)
Провалено: 2 (4.4%)
Покрытие кода: 82.3%

Детализация по компонентам:
- VideoProcessor: 12/12 пройдено
- VideoExporter: 15/16 пройдено
- Marker: 8/8 пройдено
- ProjectManager: 8/9 пройдено
```

#### Отчет о системном тестировании
```
Тестовый набор: System Tests
Длительность выполнения: 28 минут
Память: пиковое использование 1.2 GB
CPU: средняя загрузка 45%

Результаты:
- Функциональные тесты: 38/40 пройдено (95%)
- Производительность: все метрики в норме
- Стабильность: 0 сбоев за 4 часа тестирования
```

### 1.7.4.2 Метрики качества

#### Метрики покрытия кода:
- **Statement Coverage**: ≥ 80%
- **Branch Coverage**: ≥ 75%
- **Function Coverage**: ≥ 85%
- **Class Coverage**: ≥ 90%

#### Метрики производительности:
- **Время загрузки видео**: ≤ 5 секунд для 1GB файла
- **Время экспорта**: ≤ 2x длительности видео
- **Потребление памяти**: ≤ 2GB при работе
- **CPU загрузка**: ≤ 50% при воспроизведении

#### Метрики надежности:
- **MTBF**: ≥ 8 часов
- **Crash Rate**: ≤ 0.1% от сессий
- **Data Loss Rate**: 0%

### 1.7.4.3 Процедуры обработки дефектов

#### Классификация дефектов:

| Severity | Описание | Критерии исправления |
|----------|----------|----------------------|
| 1 (Critical) | Сбой приложения, потеря данных | Исправить немедленно |
| 2 (Major) | Значительная потеря функциональности | Исправить в текущем релизе |
| 3 (Minor) | Незначительные проблемы UI/UX | Исправить при возможности |
| 4 (Trivial) | Косметические дефекты | Отложить до следующего релиза |

#### Процесс обработки дефектов:

1. **Регистрация**: Автоматическая регистрация в системе отслеживания
2. **Анализ**: Определение severity и priority
3. **Исправление**: Разработка и тестирование фикса
4. **Валидация**: Регрессионное тестирование
5. **Закрытие**: Подтверждение исправления

#### Регрессионное тестирование:

- Запуск полного набора тестов после каждого фикса
- Приоритетное выполнение тест-кейсов связанных компонентов
- Проверка обратной совместимости
- Валидация производительности

### 1.7.4.4 Заключение

По результатам испытаний программное обеспечение "Hockey Editor" соответствует заявленным требованиям и готово к выпуску при условии:

1. Исправления всех дефектов severity 1 и 2
2. Достижения минимального покрытия кода 80%
3. Успешного прохождения приемочного тестирования
4. Положительных отзывов пользователей-тестеров

Все тестовые артефакты, скрипты и отчеты хранятся в репозитории проекта в директории `/tests` и `/docs/testing`.
