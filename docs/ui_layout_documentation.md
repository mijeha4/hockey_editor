# Документация интерфейса Hockey Editor

## Обзор
Данная документация описывает точное расположение всех элементов интерфейса в приложении Hockey Editor. Каждый раздел соответствует отдельному окну или компоненту UI с подробным описанием структуры, расположения элементов и их функциональности.

## 1. Главное окно (MainWindow)

### Общая структура
Главное окно разделено на вертикальные секции:
- **Верхняя часть (70% высоты)**: QSplitter с видео и списком сегментов
- **Средняя часть**: Таймлайн
- **Нижняя часть**: Панель событий и статус-бар

### 1.1 Верхняя часть - Видео и список сегментов

#### Левая панель - Видео плеер
```
┌─────────────────────────────────────────────────┐
│                    ВИДЕО                        │
│  ┌─────────────────────────────────────────┐    │
│  │              [ВИДЕО КОНТЕНТ]            │    │
│  │                                         │    │
│  │              (640x360 минимум)          │    │
│  │                                         │    │
│  └─────────────────────────────────────────┘    │
│                                                 │
│  [◀◀] [▶/⏸] [▶▶]  Speed: [1.0x ▼]             │
└─────────────────────────────────────────────────┘
```

**Элементы управления видео (снизу, приклеено к нижней части):**
- Кнопка уменьшения скорости: `⏪` (левая позиция)
- Кнопка Play/Pause: `▶` или `⏸` (центральная, большая, ширина 60px)
- Кнопка увеличения скорости: `⏩` (правая позиция)
- Растяжка (stretch)
- Метка "Speed:" (справа от растяжки)
- Выпадающий список скорости: `[1.0x ▼]` (ширина 60px, значения: 0.25x, 0.5x, 0.75x, 1.0x, 1.25x, 1.5x, 2.0x, 3.0x, 4.0x)

#### Правая панель - Список сегментов
```
┌─────────────────────────────────────────────────┐
│                    ОТРЕЗКИ:                     │
│                                                 │
│  ┌─────────────────────────────────────────┐    │
│  │ Тип: [Все ▼] [Заметки] [Сброс]          │    │
│  └─────────────────────────────────────────┘    │
│                                                 │
│  ┌─────────────────────────────────────────┐    │
│  │ [ТАБЛИЦА СЕГМЕНТОВ]                     │    │
│  │ ID │ Название │ Начало │ Конец │ Длит.│    │
│  │ 1  │ Атака    │ 00:15  │ 00:22 │ 00:07 │▶✏🗑│
│  │ 2  │ Защита   │ 00:45  │ 00:51 │ 00:06 │▶✏🗑│
│  └─────────────────────────────────────────┘    │
└─────────────────────────────────────────────────┘
```

**Фильтры (первая строка):**
- Метка "Тип:" (ширина 25px)
- Выпадающий список типов: `[Все ▼]` (ширина 100px, опции: "Все", названия событий)
- Чекбокс "Заметки" (фильтр по наличию заметок)
- Кнопка "Сброс" (ширина 45px, сбрасывает все фильтры)

**Таблица сегментов:**
- Колонки: ID(30px), Название(растягивается), Начало(60px), Конец(60px), Длительность(70px), Действия(90px)
- Кнопки действий в каждой строке: ▶ (переход), ✏ (редактирование), 🗑 (удаление)

### 1.2 Средняя часть - Таймлайн
```
┌─────────────────────────────────────────────────┐
│                    ТАЙМЛАЙН:                    │
│                                                 │
│  ┌─────────────────────────────────────────┐    │
│  │ [ЛИНЕЙКА ВРЕМЕНИ]                       │    │
│  │ 00:00   00:05   00:10   00:15   00:20   │    │
│  │                                         │    │
│  │ [ТРЕКИ СОБЫТИЙ]                         │    │
│  │ ┌─────────────────────────────────────┐ │    │
│  │ │ Атака: [███████] [████████]         │ │    │
│  │ └─────────────────────────────────────┘ │    │
│  │ ┌─────────────────────────────────────┐ │    │
│  │ │ Защита: [████████████]              │ │    │
│  │ └─────────────────────────────────────┘ │    │
│  └─────────────────────────────────────────┘    │
└─────────────────────────────────────────────────┘
```

**Структура таймлайна:**
- Линейка времени вверху (30px высота)
- Заголовки треков слева (140px ширина, темно-серый фон)
- Графические сегменты на треках (цветные прямоугольники с текстом)
- Желтая линия плейхеда (вертикальная)
- Красная линия конца видео (вертикальная)

### 1.3 Нижняя часть - Панель событий и статус
```
┌─────────────────────────────────────────────────┐
│ ┌─────────────────────────────────────────┐     │
│ │ [ГОРЯЧИЕ КЛАВИШИ СОБЫТИЙ]              │     │
│ │ ▼ Атака [A]                            │     │
│ │ ▼ Защита [D]                           │     │
│ │ ▼ Смена [S]                            │     │
│ └─────────────────────────────────────────┘     │
│                                                 │
│                    [СТАТУС-БАР]                 │
└─────────────────────────────────────────────────┘
```

**Левая часть - Список горячих клавиш:**
- Заголовок "Горячие клавиши событий" с кнопкой сворачивания ▼/▶
- Список событий с цветными индикаторами и горячими клавишами в квадратных скобках

**Правая часть - Статус-бар:**
- Текущая позиция / длительность видео
- Количество отрезков
- FPS
- Скорость воспроизведения
- Индикатор воспроизведения (▶ если играет)

### 1.4 Меню приложения
```
Файл:
├── Новый проект
├── Открыть проект
├── Открыть видео
├── Сохранить проект
├── Сохранить проект как...
├── ──────────
├── Недавние проекты >
└── Выход

┌─ Действия в панели меню ─┐
│ [Предпросмотр] [Настройки] [Экспорт] │
```

## 2. Окно редактирования сегмента (InstanceEditWindow)

### Общая структура
```
┌─────────────────────────────────────────────────┐
│ Instance Edit - Атака (1/5)                    │
│                                                │
│ ┌─────────────────────────────────────────┐    │
│ │              [ВИДЕО КОНТЕНТ]            │    │
│ │                                         │    │
│ │              (масштабируется)           │    │
│ └─────────────────────────────────────────┘    │
│                                                │
│ 00:15 [══════════════════════════════] 00:22   │
│                                                │
│ ◀ IN ▶              ▶ Play Loop ☐ Loop       ◀ OUT ▶ │
│                                                │
│ Code: [Атака ▼]    Note: [Заметка о моменте]   │
│                                                │
│ ◀ Предыдущий              ✓ Сохранить              Следующий ▶ │
└─────────────────────────────────────────────────┘
```

### 2.1 Видео плеер
- Полноразмерный видео контент в верхней части
- Масштабируется под размер окна

### 2.2 Панель тримминга
- Таймкоды начала и конца: `00:15` `[слайдер]` `00:22`
- Визуальный таймлайн с контекстным масштабированием
- Ручки IN/OUT для точного позиционирования

### 2.3 Кнопки управления
**Группа IN (слева):**
- ◀ (минус 1 кадр)
- " IN " (метка)
- ▶ (плюс 1 кадр)

**Центр:**
- ▶ Play Loop (воспроизведение в цикле)
- ☐ Loop (чекбокс зацикливания)

**Группа OUT (справа):**
- ◀ (минус 1 кадр)
- " OUT " (метка)
- ▶ (плюс 1 кадр)

### 2.4 Редактор данных
- Code: [выпадающий список типов событий]
- Note: [поле ввода заметки]

### 2.5 Кнопки действий
- ◀ Предыдущий (навигация между сегментами)
- ✓ Сохранить (зеленая, акцентная)
- Следующий ▶ (навигация между сегментами)

## 3. Окно настроек (SettingsDialog)

### Структура с вкладками
```
┌─────────────────────────────────────────────────┐
│                   Настройки                     │
│                                                │
│ ┌─────────────────────────────────────────┐    │
│ │ 📝 Управление событиями                 │    │
│ └─────────────────────────────────────────┘    │
│                                                │
│ ┌─────┬───────────────────────────────────┐    │
│ │Режим│ Режим записи: [Динамический ▼]    │    │
│ │запи-│                                   │    │
│ │си    │ Фиксированная длительность: [30] │    │
│ │      │                                   │    │
│ │      │ Предварительный откат: [2.0]     │    │
│ │      │                                   │    │
│ │      │ Добавление в конец: [1.0]        │    │
│ └─────┴───────────────────────────────────┘    │
│                                                │
│ ┌─────┬───────────────────────────────────┐    │
│ │Горя- │ Настройки горячих клавиш:        │    │
│ │чие  │                                   │    │
│ │клави│ Управляются в диалоге 'Управление│    │
│ │ши   │ событий' ниже.                    │    │
│ └─────┴───────────────────────────────────┘    │
│                                                │
│ ┌─────┬───────────────────────────────────┐    │
│ │Авто-│ ☐ Включить автосохранение         │    │
│ │сохра│                                   │    │
│ │нение│ Интервал: [5] минут               │    │
│ └─────┴───────────────────────────────────┘    │
│                                                │
│                    [💾 Сохранить] [✕ Отмена]   │
└─────────────────────────────────────────────────┘
```

### Вкладка "Режим записи"
- Режим записи: выпадающий список ["Динамический (2 нажатия)", "Фиксированная длина (1 нажатие)"]
- Фиксированная длительность: спинбокс секунд (1-120)
- Предварительный откат: дабл-спинбокс секунд (0.0-10.0)
- Добавление в конец: дабл-спинбокс секунд (0.0-10.0)

### Вкладка "Горячие клавиши"
- Информационный текст о настройке горячих клавиш
- Ссылка на диалог управления событиями

### Вкладка "Автосохранение"
- Чекбокс "Включить автосохранение"
- Спинбокс интервала (1-60 минут)

### Кнопки управления событиями
- Кнопка "📝 Управление событиями" (открывает CustomEventManagerDialog)

## 4. Диалог управления событиями (CustomEventManagerDialog)

### Основной диалог
```
┌─────────────────────────────────────────────────┐
│            Manage Event Types                   │
│                                                │
│ Event Types:                                   │
│ ┌─────────────────────────────────────────┐    │
│ │ ■ Атака [A] - Offensive play            │    │
│ │ ■ Защита [D] - Defensive action         │    │
│ │ ■ Смена [S] - Shift change              │    │
│ └─────────────────────────────────────────┘    │
│                                                │
│ [➕ Add Event] [✏️ Edit] [🗑️ Delete] [↺ Reset] │
│                                                │
│                    [Close]                     │
└─────────────────────────────────────────────────┘
```

### Диалог добавления/редактирования события
```
┌─────────────────────────────────────────────────┐
│            Add Event Type                      │
│                                                │
│ Event Name: [____________________]             │
│                                                │
│ Description: [____________________]            │
│                                                │
│ Shortcut: [____________________]               │
│                                                │
│ Color: ■ [Choose Color...]                     │
│                                                │
│                [OK] [Cancel]                   │
└─────────────────────────────────────────────────┘
```

## 5. Окно экспорта (ExportDialog)

### Структура
```
┌─────────────────────────────────────────────────┐
│              Export Segments                    │
│                                                │
│ Segments to Export:                            │
│ [Select All] [Deselect All]                    │
│ ┌─────────────────────────────────────────┐    │
│ │ ☑ 1. Атака (00:15–00:22) [00:07]       │    │
│ │ ☑ 2. Защита (00:45–00:51) [00:06]     │    │
│ └─────────────────────────────────────────┘    │
│                                                │
│ Video Options:                                 │
│ Codec: [h264 ▼]  Resolution: [Source ▼]        │
│ Quality: [Medium ▼] [23 CRF ▼]                 │
│ Format: [MP4 ▼]                                │
│ ☑ Include Audio  ☑ Merge Segments             │
│                                                │
│ Export Progress:                               │
│ Ready to export                                │
│ [████████████████████████] 0%                  │
│                                                │
│ [📁 Browse Output]           [▶ Export] [✕ Cancel] │
└─────────────────────────────────────────────────┘
```

### Группа "Segments to Export"
- Кнопки управления выбором: Select All, Deselect All
- Список чекбоксов сегментов с временем и длительностью

### Группа "Video Options"
- Codec: выпадающий список (h264, h265, mpeg4, copy)
- Resolution: выпадающий список (Source, 2160p, 1080p, 720p, 480p, 360p)
- Quality: выпадающий список (High, Medium, Low, Custom) + CRF спинбокс
- Format: выпадающий список (MP4, MOV, MKV, WebM)
- Чекбоксы: Include Audio, Merge Segments

### Группа "Export Progress"
- Статусная метка
- Прогресс-бар (0-100%)

## 6. Окно предпросмотра (PreviewWindow)

### Общая структура
```
┌─────────────────────────────────────────────────┐
│ 🎬 Кинотеатр событий - Презентация тренерам     │
│                                                │
│ ┌─────────────────┬─────────────────────────┐  │
│ │    ВИДЕО        │        СПИСОК КАРТОЧЕК  │  │
│ │  ┌─────────┐    │  ┌───────────────────┐  │  │
│ │  │[ВИДЕО]  │    │  │ Тип: [Все ▼] [Заметки]│  │
│ │  │         │    │  │ Поиск: [_________]    │  │
│ │  │         │    │  │                       │  │
│ │  │         │    │  │ ┌─────────────────┐   │  │
│ │  │         │    │  │ │#1 00:15 00:07   │   │  │
│ │  │         │    │  │ │■ Атака          │   │  │
│ │  │         │    │  │ │[Заметка о моменте]│   │  │
│ │  │         │    │  │ │     ✏️ 🗑️       │   │  │
│ │  │         │    │  │ └─────────────────┘   │  │
│ │  └─────────┘    │  └───────────────────┘  │  │
│ │                 │                         │  │
│ │  ┌─────────┐    │                         │  │
│ │  │👆 📏 ▭ ○ ➤│    │                         │  │
│ │  │Цвет:Красный│    │                         │  │
│ │  │Толщ: 2     │    │                         │  │
│ │  │🗑️ Очистить │    │                         │  │
│ │  └─────────┘    │                         │  │
│ │                 │                         │  │
│ │ ▶ Play  [───────█──────] 00:00/00:07 Speed:1.0x│
│ └─────────────────┴─────────────────────────┘  │
└─────────────────────────────────────────────────┘
```

### Левая панель - Видео с рисованием
**Видео плеер:**
- Полноразмерное видео в верхней части
- Наложение для рисования

**Панель инструментов рисования:**
- Кнопки инструментов: 👆 (выбор), 📏 (линия), ▭ (прямоугольник), ○ (круг), ➤ (стрелка)
- Выбор цвета: [Красный ▼] (Красный, Зеленый, Синий, Желтый, Белый, Черный)
- Выбор толщины: [2 ▼] (1-5)
- Кнопка очистки: 🗑️ Очистить

**Контролы видео:**
- ▶ Play / ⏸ Pause
- Ползунок прогресса
- Время: 00:00/00:07
- Speed: [1.0x ▼]

### Правая панель - Список карточек событий
**Фильтры:**
- Тип: [Все ▼] [Заметки] [Сброс]
- Поиск: [_________________] (поиск в заметках)

**Карточки событий:**
```
#1 00:15 00:07
■ Атака
[Заметка о моменте]
     ✏️ 🗑️
```

Каждая карточка содержит:
- ID и время начала/длительность в заголовке
- Цветной индикатор и название события
- Текст заметки (если есть)
- Кнопки редактирования и удаления

## 7. Компоненты UI

### 7.1 PlayerControls (панель управления видео)
```
[⏪] [▶] [⏩]           Speed: [1.0x ▼]
```

### 7.2 SegmentListWidget (таблица сегментов)
```
┌─────────────────────────────────────────────────┐
│ ID │ Название │ Начало │ Конец │ Длительность │ │
│ 1  │ Атака    │ 00:15  │ 00:22 │ 00:07        │▶│
│ 2  │ Защита   │ 00:45  │ 00:51 │ 00:06        │✏│
│    │          │        │       │              │🗑│
└─────────────────────────────────────────────────┘
```

### 7.3 EventShortcutListWidget (список горячих клавиш)
```
Горячие клавиши событий ▼

■ Атака [A]
■ Защита [D]
■ Смена [S]
```

### 7.4 TimelineWidget (графический таймлайн)
```
[ЛИНЕЙКА ВРЕМЕНИ 00:00 00:05 00:10 ...]

[ЗАГОЛОВКИ ТРЕКОВ] [ГРАФИЧЕСКИЕ СЕГМЕНТЫ]
Атака:              [███████] [████████]
Защита:             [████████████]
```

## 8. Цветовая схема и стили

### Основные цвета
- Фон приложения: #2a2a2a (темно-серый)
- Фон элементов: #333333 (серый)
- Текст: #ffffff (белый)
- Акцент: #1a4d7a (синий)
- Границы: #444444 (темно-серый)

### Цвета событий
- Атака: Красный (#FF0000)
- Защита: Синий (#0000FF)
- Смена: Зеленый (#00FF00)
- Кастомные: Настраиваемые

## 9. Горячие клавиши

### Глобальные
- Space: Play/Pause
- Ctrl+O: Открыть видео
- Ctrl+S: Сохранить проект
- Ctrl+E: Экспорт
- Ctrl+Z: Отмена
- Ctrl+Shift+Z: Повтор

### В окне редактирования сегмента
- I: Установить точку входа (IN)
- O: Установить точку выхода (OUT)
- Space/K: Play/Pause
- Left/Right: Перемотка на кадр
- Shift+Left/Right: Перемотка на 10 кадров
- Tab: Переключение активной точки (IN/OUT)
- Return/Enter: Сохранить
- Escape: Закрыть

### В окне предпросмотра
- I/O: Установка точек IN/OUT
- Delete: Удаление маркера
- Shift+Arrows: Сдвиг маркера

## 10. Адаптивность и размеры

### Минимальные размеры окон
- MainWindow: 1800x1000
- InstanceEditWindow: 1000x700
- PreviewWindow: 1400x800
- SettingsDialog: 500x400
- ExportDialog: 700x650

### Предпочтительные пропорции
- Видео: 16:9 (640x360 минимум)
- Таймлайн: Автомасштабирование
- Списки: Фиксированная ширина с прокруткой

Эта документация позволяет точно воссоздать интерфейс Hockey Editor со всеми элементами управления, их расположением и функциональностью.
